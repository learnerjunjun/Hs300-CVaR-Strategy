## Title

基于收益预测和CVaR约束的投资组合优化

## 研究背景

### 改进期望收益

1. MV model 存在缺陷，模型建立在股票收益正态分布等诸多限制性假设之上，而这些假设在现实股票市场中很难成立；

- 收益基本不服从正态分布假设，使用历史收益预测投资组合的风险是不合理的

2. 这些经典的投资组合模型通常采用历史股票收益的均值作为期望收益，适用于股票市场实践中的长期投资（均值回归理论）。

- 对于短期投资，股票市场可能存在短期投机，及受市场情绪影响，上述模型可能不适合短期投资；

- 使用平均历史收益作为未来预期收益，进行股票市场进行低通滤波；（平均化处理，影响极端值及波动值）

**对此使用机器学习/深度学习的方法预测未来收益，进行短期投资**

### 改进风险度量

1. 使用方差度量风险（绝对及半绝对）

- 对异常值敏感，极端风险事件，会显著影响方差计算；
- 只关注收益率分布的前两矩，忽略分布的尾部；

2. 对此使用CVaR来度量风险损失，有三大优势：

- 对异常值不敏感
- 不依赖分布假设
- 考虑分布的尾部，更好处理异常值

## 理论建模

- $N$种资产

- **收益率矩阵 **$N\times T$
  $$
  R=
  \begin{bmatrix}
  r_1^1 & r_1^2 & r_1^3 & ... & r_1^T\\
  r_2^1 & r_2^2 & r_2^3 & ... & r_2^T\\
  r_3^1 & r_3^2 & r_3^3 & ... & r_3^T\\
  ... & ... & ... & ... & ...\\
  r_N^1 & r_N^2 & r_N^3 & ... & r_N^T\\
  \end{bmatrix}
  =
  \begin{bmatrix}
  R_1 & R_2 & R_3 &... & R_T
  \end{bmatrix}
  $$
  其中$R_t$为 $t$ 时期 $N$ 种资产的收益率矩阵；

- $t$ 时期资产组合**权重矩阵** $N \times 1$
  $$
  w=\begin{bmatrix}
  w_1 & w_2 & w_3 & ... & w_N
  \end{bmatrix}^T
  $$

- **价值损失函数**
  $$
  L(w,R)=-w^TR
  $$
  $w\in W\subseteq R^N$，$W$为可行集；$R$为随机变量，密度函数为$P(R)$;

  L(w,R)是依赖于w的随机变量，小于临界值 $\lambda$ 的概率为 $\varphi(w,\lambda)=\int_{L(w,R)\leq\lambda}P(R)dR$

- $置信水平$

  $\alpha\in(0,1)$

  $VaR$值：$\lambda_{\alpha}(w)=\text{inf}\{\lambda\in R;\varphi(w,\lambda)\geq \alpha\}$

  $CVaR$值：$\phi_{\alpha}(w)=E[L(w,R) \vert L(w,R) \geq VaR(w)]=\frac{1}{1-\alpha}\int_{L(w,R)\geq \lambda_{\alpha}(w)}L(w,R)P(R)dR$

- 利 用 Rockafellar 和 Uryasev 同时计算 $VaR$ 和 $CVaR$的功能函数$F_{\alpha}(w,R)$有

  $F_{\alpha}(w,\lambda)=\lambda+\frac{1}{1-\alpha}\int_{R\in R^N}[L(w,R)-\lambda]^{+}P(R)dR$

  其中，$\lambda$即$VaR$值，$[0,x]^+=\text{max}(0,x)$

  观察功能函数 $F_{\alpha}(w,R)$的表达式，发现即使$P(R)$的解析表达式已知,多重积分的计算仍然是一个难题；

  Rockafellar 和 Uryasev 提出，当$P(R)$的解析式未知时，可以使用基于历史数据的情景分析法，产生情景矩阵，将多重积分转化为求和运算；

  假设有$m$种情况，可以取$N$种债券$m$个时期的收益率

  $\widehat{F}_{\alpha}(w,R)=\lambda+\frac{1}{m(1-\alpha)}\sum_{t=1}^{T}[L(w,R_t)-\lambda]=\lambda+\frac{1}{m(1-\alpha)}\sum_{t=1}^{m}[-w^TR_t-\lambda]$

  `至此解决了目标函数的问题`

- 最优化问题建模

  $\text{min}_{w} \ \lambda+\frac{1}{m(1-\alpha)}\sum_{t=1}^{m}[-w^TR_t-\lambda]$

  $\text{s.t.} \ w^TI=1$

## 数值实验

- 置信水平 $\alpha=0.01$
- 策略：使用过去$6$个月的数据，预测未来$3$个月的数据，共计9个月的数据形成场景矩阵，决定下一个月的股票及权重；
- 滚动训练周期：1个月；
- 与之相对应的是使用MV模型来决定股票及权重；

## 改进

### 理论端

- 考虑交易成本

### 预测端：

- 优化ML/DNN方法

### 策略端

- 改进滚动及调仓周期

### 数据端

- 从月度数据改为高频数据

### 求解方法

- 松弛线性规划（LP）
- 次梯度算法（SA）
- 遗传算法（GA）
- 光滑化方法（SM）



