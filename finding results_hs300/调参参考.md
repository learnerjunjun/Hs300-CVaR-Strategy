# 调参结果储存与对比

## 对照组

**Set min=36,max=48,update=3,back=24，select=20**

```python
train_start_month = 94 #训练开始时间 或者从94开始，年均收益率更高
train_min_months = 36 #训练最少使用数据量
train_max_months = 48 #训练最多使用数据量
train_update_months = 3 #训练轮动周期
max_date = 284
max_select = 20 #选股最多数量
roll_back = 24 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
confidence_level = 0.99 #置信水平
```

| Column                         | Annual  Return | Max Drawdown | Return  Drawdown Ratio | Annual  Volatility | Sharpe Ratio | Information  Ratio |
| ------------------------------ | -------------- | ------------ | ---------------------- | ------------------ | ------------ | ------------------ |
| return_data_combined_coef      | 0.196843658    | 0.480068312  | 0.410032601            | 0.311535373        | 0.631850106  | 0.461430737        |
| return_data_combined_cvar_coef | 0.231590848    | 0.384329649  | 0.602583873            | 0.32640697         | 0.709515635  | 0.555092278        |
| return_data_combined_ic        | 0.181909404    | 0.545898856  | 0.333229136            | 0.322352253        | 0.564318699  | 0.374245257        |
| return_data_combined_cvar_ic   | 0.287134265    | 0.413803135  | 0.693890987            | 0.348187753        | 0.824653547  | 0.788551694        |
| return_data_combined_corr      | 0.369411791    | 0.318456898  | 1.16000562             | 0.313038613        | 1.180083785  | 1.509094195        |
| return_data_combined_cvar_corr | 0.326994064    | 0.388955641  | 0.840697574            | 0.326808157        | 1.000568857  | 1.105294841        |
| return_data_combined_hs300     | 0.113693705    | 0.427074935  | 0.266214886            | 0.247963677        | 0.458509514  | 0                  |

## 训练集数量

- train_min_months = 60

  ```python
  #以下都是需要调整的参数，包括数据量、轮动周期及选股数量
  # min=36,max=48,update=3,back=24，select=20的表现可以
  # train_start_test = 130  #测试集最早从第130个月开始 if min<45
  train_min_months = 60 #训练最少使用数据量
  train_start_month = 85 #训练开始时间 或者从94开始，避免回撤过大，年均收益率更高
  train_max_months = 48 #训练最多使用数据量
  train_update_months = 3 #训练轮动周期
  max_date = 284
  max_select = 20 #选股最多数量
  roll_back = 24 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
  CVaR_method = "minimize_cvar_scipy"
  # 优化算法
  # "differential_evolution", "genetic_algorithm", "simulated_annealing",
  # "bayesian_optimization", "particle_swarm_optimization"
  # "nlopt_optimization", "minimize_cvar_scipy"
  confidence_level = 0.99 #置信水平
  risk_free_rate = 0  # 无风险利率假设为0
  ```

  

## 置信水平

- **confidence_level = 0.98 #置信水平**

  ```python
  confidence_level = 0.98 #置信水平
  ```

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual  Volatility | Sharpe Ratio | Information  Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ------------------ | ------------ | ------------------ |
  | return_data_combined_coef      | 0.197678454   | 0.477715558  | 0.413799489            | 0.311847535        | 0.633894554  | 0.46539628         |
  | return_data_combined_cvar_coef | 0.233309026   | 0.456305565  | 0.51129998             | 0.316871405        | 0.736289304  | 0.582756254        |
  | return_data_combined_ic        | 0.181444548   | 0.548087094  | 0.331050575            | 0.322286749        | 0.562991026  | 0.37152833         |
  | return_data_combined_cvar_ic   | 0.27934454    | 0.440555648  | 0.634073222            | 0.347014884        | 0.804992962  | 0.765424216        |
  | return_data_combined_corr      | 0.368694916   | 0.311526069  | 1.183512239            | 0.31316034         | 1.177335916  | 1.50478454         |
  | return_data_combined_cvar_corr | 0.346566707   | 0.383765731  | 0.903068406            | 0.325991335        | 1.063116314  | 1.286709898        |
  | return_data_combined_hs300     | 0.113693705   | 0.427074935  | 0.266214886            | 0.247963677        | 0.458509514  | 0                  |

  

- **confidence_level = 0.97 #置信水平**

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.197377      | 0.478876     | 0.412168               | 0.311741          | 0.633145     | 0.463514          |
  | return_data_combined_cvar_coef | 0.231214      | 0.452898     | 0.510521               | 0.31054           | 0.744554     | 0.589877          |
  | return_data_combined_ic        | 0.181363      | 0.549207     | 0.330227               | 0.322528          | 0.562316     | 0.370886          |
  | return_data_combined_cvar_ic   | 0.241528      | 0.460331     | 0.524684               | 0.334752          | 0.721515     | 0.623221          |
  | return_data_combined_corr      | 0.37137       | 0.31237      | 1.188876               | 0.313067          | 1.186231     | 1.519868          |
  | return_data_combined_cvar_corr | 0.292665      | 0.366031     | 0.799562               | 0.299022          | 0.978738     | 1.151976          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

- **confidence_level = 0.96 #置信水平**

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.19793       | 0.477746     | 0.414299               | 0.31159           | 0.635224     | 0.467268          |
  | return_data_combined_cvar_coef | 0.152113      | 0.545069     | 0.279071               | 0.308319          | 0.493361     | 0.196792          |
  | return_data_combined_ic        | 0.18165       | 0.547633     | 0.3317                 | 0.322416          | 0.563401     | 0.372608          |
  | return_data_combined_cvar_ic   | 0.251502      | 0.429828     | 0.585122               | 0.311795          | 0.806625     | 0.712951          |
  | return_data_combined_corr      | 0.369821      | 0.314769     | 1.174895               | 0.312968          | 1.181656     | 1.51075           |
  | return_data_combined_cvar_corr | 0.361013      | 0.311019     | 1.160741               | 0.314593          | 1.147556     | 1.355046          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

- **confidence_level = 0.95 #置信水平**

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.1975        | 0.480364     | 0.411147               | 0.311739          | 0.633544     | 0.464399          |
  | return_data_combined_cvar_coef | 0.186925      | 0.467885     | 0.39951                | 0.306099          | 0.610668     | 0.36705           |
  | return_data_combined_ic        | 0.182035      | 0.546524     | 0.333078               | 0.322399          | 0.564627     | 0.374928          |
  | return_data_combined_cvar_ic   | 0.299076      | 0.48009      | 0.622958               | 0.328694          | 0.909892     | 0.838327          |
  | return_data_combined_corr      | 0.369641      | 0.315417     | 1.171914               | 0.313029          | 1.180852     | 1.508291          |
  | return_data_combined_cvar_corr | 0.368053      | 0.282132     | 1.30454                | 0.310165          | 1.186637     | 1.386636          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

- **confidence_level = 0.94 #置信水平**

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.197363      | 0.480164     | 0.411032               | 0.311632          | 0.633321     | 0.463972          |
  | return_data_combined_cvar_coef | 0.161759      | 0.493104     | 0.328042               | 0.299331          | 0.540402     | 0.259798          |
  | return_data_combined_ic        | 0.181236      | 0.548033     | 0.330703               | 0.322474          | 0.562018     | 0.370365          |
  | return_data_combined_cvar_ic   | 0.189214      | 0.525013     | 0.360398               | 0.308807          | 0.612724     | 0.403316          |
  | return_data_combined_corr      | 0.368853      | 0.312893     | 1.178849               | 0.31265           | 1.179764     | 1.507539          |
  | return_data_combined_cvar_corr | 0.305751      | 0.37395      | 0.817626               | 0.315765          | 0.968287     | 1.030464          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

## 决策集数量

- roll_back = 28

  ```python
  train_start_test = 129 #测试集最早从第129个月开始
  train_min_months = 36 #训练最少使用数据量
  train_start_month = train_start_test - train_min_months #训练开始时间
  train_max_months = 48 #训练最多使用数据量
  train_update_months = 3 #训练轮动周期
  max_date = 284
  max_select = 20 #选股最多数量
  roll_back = 28 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
  confidence_level = 0.99 #置信水平
  ```

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.224837      | 0.361386     | 0.622151               | 0.324383          | 0.693122     | 0.561139          |
  | return_data_combined_cvar_coef | 0.156591      | 0.469969     | 0.333195               | 0.309038          | 0.506705     | 0.217978          |
  | return_data_combined_ic        | 0.233923      | 0.526583     | 0.444228               | 0.313482          | 0.746209     | 0.654163          |
  | return_data_combined_cvar_ic   | 0.215476      | 0.448093     | 0.480874               | 0.325416          | 0.662155     | 0.497347          |
  | return_data_combined_corr      | 0.374123      | 0.365115     | 1.024672               | 0.319036          | 1.172668     | 1.49219           |
  | return_data_combined_cvar_corr | 0.373352      | 0.401847     | 0.929089               | 0.351853          | 1.0611       | 1.250834          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- roll_back = 22

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.18763       | 0.503469     | 0.372675               | 0.33725           | 0.556355     | 0.371834          |
  | return_data_combined_cvar_coef | 0.181089      | 0.551919     | 0.328107               | 0.338745          | 0.534587     | 0.292966          |
  | return_data_combined_ic        | 0.207955      | 0.529827     | 0.392497               | 0.323768          | 0.642298     | 0.499253          |
  | return_data_combined_cvar_ic   | 0.1877        | 0.552544     | 0.339701               | 0.340085          | 0.551921     | 0.349109          |
  | return_data_combined_corr      | 0.339508      | 0.318265     | 1.066745               | 0.309561          | 1.096739     | 1.272491          |
  | return_data_combined_cvar_corr | 0.356805      | 0.301774     | 1.182356               | 0.320693          | 1.112607     | 1.268351          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- roll_back = 20

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.154271      | 0.592572     | 0.260341               | 0.339214          | 0.454789     | 0.205094          |
  | return_data_combined_cvar_coef | 0.169522      | 0.518671     | 0.326838               | 0.341373          | 0.496588     | 0.248214          |
  | return_data_combined_ic        | 0.165811      | 0.569566     | 0.291119               | 0.324211          | 0.511431     | 0.291123          |
  | return_data_combined_cvar_ic   | 0.215254      | 0.522338     | 0.412097               | 0.362488          | 0.593825     | 0.447135          |
  | return_data_combined_corr      | 0.311537      | 0.432724     | 0.719942               | 0.319448          | 0.975235     | 1.092131          |
  | return_data_combined_cvar_corr | 0.29676       | 0.394746     | 0.751774               | 0.338879          | 0.87571      | 0.903871          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- roll_back = 18

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.253058      | 0.557164     | 0.45419                | 0.342178          | 0.739551     | 0.671418          |
  | return_data_combined_cvar_coef | 0.21628       | 0.477519     | 0.452924               | 0.332395          | 0.650671     | 0.46431           |
  | return_data_combined_ic        | 0.211659      | 0.45296      | 0.46728                | 0.328863          | 0.643608     | 0.496186          |
  | return_data_combined_cvar_ic   | 0.190798      | 0.642397     | 0.297009               | 0.361538          | 0.527739     | 0.312634          |
  | return_data_combined_corr      | 0.361734      | 0.463872     | 0.779814               | 0.334782          | 1.080505     | 1.356266          |
  | return_data_combined_cvar_corr | 0.271539      | 0.481165     | 0.564336               | 0.339424          | 0.799999     | 0.795864          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

## 训练集数据量

- **confidence_level = 0.95 #置信水平**

- train_min_months = 35 #训练最少使用数据量

  ```python
  train_start_test = 129 #测试集最早从第129个月开始
  train_min_months = 35 #训练最少使用数据量
  train_start_month = train_start_test - train_min_months #训练开始时间
  train_max_months = 48 #训练最多使用数据量
  train_update_months = 3 #训练轮动周期
  max_date = 284
  max_select = 20 #选股最多数量
  roll_back = 24 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
  confidence_level = 0.95 #置信水平
  ```

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.163725      | 0.621048     | 0.263627               | 0.334436          | 0.489554     | 0.264155          |
  | return_data_combined_cvar_coef | 0.141996      | 0.531711     | 0.267055               | 0.330967          | 0.429034     | 0.146558          |
  | return_data_combined_ic        | 0.14226       | 0.536288     | 0.265269               | 0.321939          | 0.441886     | 0.158203          |
  | return_data_combined_cvar_ic   | 0.180993      | 0.4224       | 0.428488               | 0.313439          | 0.577443     | 0.338866          |
  | return_data_combined_corr      | 0.332191      | 0.358849     | 0.925713               | 0.320514          | 1.036431     | 1.289632          |
  | return_data_combined_cvar_corr | 0.327252      | 0.376562     | 0.869052               | 0.312197          | 1.048224     | 1.187701          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- train_min_months = 37 #训练最少使用数据量

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.186342      | 0.541058     | 0.344403               | 0.321588          | 0.579444     | 0.406926          |
  | return_data_combined_cvar_coef | 0.153695      | 0.585296     | 0.262594               | 0.324869          | 0.473099     | 0.252591          |
  | return_data_combined_ic        | 0.147492      | 0.516217     | 0.285717               | 0.31616           | 0.466511     | 0.232344          |
  | return_data_combined_cvar_ic   | 0.105004      | 0.586676     | 0.178982               | 0.325798          | 0.322299     | 0.003791          |
  | return_data_combined_corr      | 0.33812       | 0.334931     | 1.009522               | 0.307394          | 1.099957     | 1.415941          |
  | return_data_combined_cvar_corr | 0.315615      | 0.338009     | 0.933749               | 0.29751           | 1.060855     | 1.246285          |
  | return_data_combined_hs300     | 0.104247      | 0.427075     | 0.244096               | 0.246057          | 0.423672     | 0                 |

- train_min_months = 38 #训练最少使用数据量

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.207443      | 0.409028     | 0.507162               | 0.319348          | 0.649585     | 0.557034          |
  | return_data_combined_cvar_coef | 0.155196      | 0.442084     | 0.351055               | 0.306442          | 0.506445     | 0.315013          |
  | return_data_combined_ic        | 0.137429      | 0.465993     | 0.294916               | 0.315958          | 0.434959     | 0.203853          |
  | return_data_combined_cvar_ic   | 0.144528      | 0.518123     | 0.278945               | 0.311586          | 0.463845     | 0.223593          |
  | return_data_combined_corr      | 0.322695      | 0.396105     | 0.814669               | 0.310447          | 1.039453     | 1.317444          |
  | return_data_combined_cvar_corr | 0.278511      | 0.358855     | 0.776109               | 0.300069          | 0.928156     | 1.089694          |
  | return_data_combined_hs300     | 0.099918      | 0.427075     | 0.233959               | 0.248177          | 0.402609     | 0                 |

- train_min_months = 32 #训练最少使用数据量

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.21045       | 0.395851     | 0.531639               | 0.325706          | 0.646134     | 0.604453          |
  | return_data_combined_cvar_coef | 0.170291      | 0.436583     | 0.390054               | 0.333129          | 0.511187     | 0.38864           |
  | return_data_combined_ic        | 0.122105      | 0.647478     | 0.188586               | 0.338477          | 0.360749     | 0.157734          |
  | return_data_combined_cvar_ic   | 0.074643      | 0.645243     | 0.115683               | 0.319189          | 0.233854     | -0.08988          |
  | return_data_combined_corr      | 0.265875      | 0.371321     | 0.716026               | 0.325827          | 0.816001     | 1.062804          |
  | return_data_combined_cvar_corr | 0.293555      | 0.361781     | 0.811415               | 0.325629          | 0.901501     | 1.114831          |
  | return_data_combined_hs300     | 0.091252      | 0.427075     | 0.213666               | 0.258484          | 0.353026     | 0                 |

- train_min_months = 28 #训练最少使用数据量

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.154128      | 0.448577     | 0.343593               | 0.316864          | 0.486415     | 0.224034          |
  | return_data_combined_cvar_coef | 0.142176      | 0.488359     | 0.291131               | 0.316799          | 0.44879      | 0.153461          |
  | return_data_combined_ic        | 0.130707      | 0.58901      | 0.221909               | 0.345175          | 0.378667     | 0.092322          |
  | return_data_combined_cvar_ic   | 0.13881       | 0.640293     | 0.216792               | 0.328383          | 0.422708     | 0.133541          |
  | return_data_combined_corr      | 0.278888      | 0.414948     | 0.672104               | 0.311125          | 0.896387     | 1.032095          |
  | return_data_combined_cvar_corr | 0.356199      | 0.371963     | 0.957621               | 0.296737          | 1.200385     | 1.471077          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

## 局部最优到全局最优

- **train_min_months = 28 #训练最少使用数据量**

  **confidence_level = 0.99 #置信水平**

  ```python
  train_start_test = 129 #测试集最早从第129个月开始
  train_min_months = 28 #训练最少使用数据量
  train_start_month = train_start_test - train_min_months #训练开始时间
  train_max_months = 48 #训练最多使用数据量
  train_update_months = 3 #训练轮动周期
  max_date = 284
  max_select = 20 #选股最多数量
  roll_back = 24 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
  confidence_level = 0.99 #置信水平
  ```

  

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.155289      | 0.448737     | 0.346057               | 0.316866          | 0.490078     | 0.230288          |
  | return_data_combined_cvar_coef | 0.070452      | 0.629862     | 0.111853               | 0.322111          | 0.218719     | -0.19743          |
  | return_data_combined_ic        | 0.130798      | 0.587555     | 0.222614               | 0.345266          | 0.378832     | 0.09268           |
  | return_data_combined_cvar_ic   | 0.181608      | 0.512589     | 0.354296               | 0.333623          | 0.544351     | 0.35229           |
  | return_data_combined_corr      | 0.279162      | 0.414538     | 0.673429               | 0.311171          | 0.897133     | 1.033826          |
  | return_data_combined_cvar_corr | 0.317163      | 0.440443     | 0.720098               | 0.324949          | 0.976037     | 1.059519          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- **train_min_months = 28 #训练最少使用数据量**

  **confidence_level = 0.98 #置信水平**

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.155015      | 0.441902     | 0.350792               | 0.316628          | 0.489582     | 0.228912          |
  | return_data_combined_cvar_coef | 0.10601       | 0.587489     | 0.180446               | 0.32405           | 0.327141     | -0.02846          |
  | return_data_combined_ic        | 0.130575      | 0.589953     | 0.221331               | 0.345392          | 0.378048     | 0.091557          |
  | return_data_combined_cvar_ic   | 0.175948      | 0.574941     | 0.306028               | 0.350004          | 0.502704     | 0.309611          |
  | return_data_combined_corr      | 0.27948       | 0.410782     | 0.68036                | 0.31099           | 0.898678     | 1.036105          |
  | return_data_combined_cvar_corr | 0.292882      | 0.434953     | 0.673366               | 0.3184            | 0.919856     | 1.011393          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

## 调整配比方法

- IC-0.6/0.4

  为大于0.03的分配0.6的总权重，其余是0.4权重

- Corr-0.2/0.8

  前两个调整到0.2总权重，其余为0.8权重
  
  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.213715      | 0.42545      | 0.502327               | 0.333879          | 0.640097     | 0.518827          |
  | return_data_combined_cvar_coef | 0.208365      | 0.481847     | 0.432429               | 0.326267          | 0.638631     | 0.424916          |
  | return_data_combined_ic        | 0.132717      | 0.597918     | 0.221966               | 0.328624          | 0.403859     | 0.107785          |
  | return_data_combined_cvar_ic   | 0.136554      | 0.54595      | 0.250122               | 0.329739          | 0.414127     | 0.121613          |
  | return_data_combined_corr      | 0.333608      | 0.388164     | 0.859451               | 0.325029          | 1.026394     | 1.254339          |
  | return_data_combined_cvar_corr | 0.317298      | 0.431821     | 0.73479                | 0.337458          | 0.940259     | 1.043448          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

## 求解方法

除了 `cvxpy` 和 `scipy.optimize`，还有一些其他流行的优化库和方法可用于求解非线性优化问题：

1. **Pyomo**：Pyomo 是一个建模和求解数学优化问题的 Python 库，它支持线性、非线性、混合整数优化等各种类型的优化问题。

2. **Gurobi** 和 **CPLEX**：这是两个商业级别的优化器，用于求解大规模线性和混合整数优化问题。它们具有出色的性能，尤其在大规模优化问题上效果显著。

3. **DEAP** 和 **scikit-optimize**：这些库提供了演化算法和贝叶斯优化算法等元启发式方法来解决优化问题。

4. **NLopt**：这是一个专门用于非线性优化的开源库，提供了多种优化算法，包括局部和全局优化方法。

5. **Optuna**：Optuna 是一个用于超参数优化的库，采用了一种基于模型的、自适应的方法来寻找最优解。虽然主要用于超参数调优，但也可用于一般的优化问题。

这些库都具有不同的特点、适用场景和性能表现。选择合适的优化器通常需要考虑问题的复杂性、约束条件、对精度的要求以及可用的计算资源。你可以根据你的需求和问题的性质尝试使用其中的一些库来求解非线性优化问题。

寻找全局最优解对于非线性优化问题通常更具挑战性。并没有通用的解决方案能够确保找到全局最优解，因为这取决于问题本身的特性以及优化算法的性能。

一些方法可能更适合在非凸问题中寻找全局最优解，例如：

1. **全局优化算法**：一些专门针对全局优化的算法，比如差分进化算法、遗传算法、模拟退火等，通常对于全局最优解的搜索有一定的优势。例如，DEAP、Differential Evolution 和 Particle Swarm Optimization (PSO) 等算法可能在一定程度上帮助寻找全局最优解。

2. **多启发式算法**：有时候，结合多个不同的启发式算法可以提高找到全局最优解的可能性。比如，结合遗传算法和模拟退火算法，或者使用多种算法的组合。

3. **贝叶斯优化**：贝叶斯优化算法可以在全局搜索和局部搜索之间进行权衡，能够更好地处理非凸性问题，并在一定程度上帮助找到全局最优解。

4. **网格搜索**：虽然网格搜索方法通常用于参数空间的穷举搜索，但对于某些非凸问题，通过细致地在参数空间中进行搜索，也可以在一定程度上找到全局最优解。

在选择全局优化算法时，要考虑问题的复杂性、计算资源、运行时间和对结果精度的要求。在实践中，可能需要尝试多种方法，并对结果进行评估和比较，以找到最适合你问题的解决方案。

- differential_evolution

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.214195      | 0.422715     | 0.506714               | 0.333619          | 0.642036     | 0.521916          |
  | return_data_combined_cvar_coef | 0.213459      | 0.480161     | 0.444557               | 0.325079          | 0.656637     | 0.44876           |
  | return_data_combined_ic        | 0.134029      | 0.596137     | 0.22483                | 0.328398          | 0.408132     | 0.114643          |
  | return_data_combined_cvar_ic   | 0.14098       | 0.528891     | 0.266557               | 0.328296          | 0.429428     | 0.144154          |
  | return_data_combined_corr      | 0.332033      | 0.388496     | 0.854662               | 0.324997          | 1.021649     | 1.245801          |
  | return_data_combined_cvar_corr | 0.322731      | 0.397407     | 0.812091               | 0.336594          | 0.958814     | 1.080215          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- genetic_algorithm

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.215862      | 0.421165     | 0.512535               | 0.333462          | 0.647335     | 0.531098          |
  | return_data_combined_cvar_coef | 0.183205      | 0.457583     | 0.400375               | 0.305086          | 0.600501     | 0.367112          |
  | return_data_combined_ic        | 0.132651      | 0.599281     | 0.221351               | 0.328566          | 0.403727     | 0.107443          |
  | return_data_combined_cvar_ic   | 0.174337      | 0.52172      | 0.334157               | 0.32638           | 0.534152     | 0.331318          |
  | return_data_combined_corr      | 0.333669      | 0.387338     | 0.86144                | 0.325069          | 1.026457     | 1.254603          |
  | return_data_combined_cvar_corr | 0.266222      | 0.344023     | 0.77385                | 0.308145          | 0.863952     | 0.935715          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- simulated_annealing

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.196845      | 0.480609     | 0.409573               | 0.311787          | 0.631344     | 0.460747          |
  | return_data_combined_cvar_coef | 0.220197      | 0.471298     | 0.467215               | 0.303582          | 0.725331     | 0.550483          |
  | return_data_combined_ic        | 0.131079      | 0.541251     | 0.242178               | 0.315089          | 0.416008     | 0.097713          |
  | return_data_combined_cvar_ic   | 0.207961      | 0.471469     | 0.441092               | 0.317584          | 0.654822     | 0.51683           |
  | return_data_combined_corr      | 0.398804      | 0.326408     | 1.221795               | 0.328986          | 1.212222     | 1.530402          |
  | return_data_combined_cvar_corr | 0.298817      | 0.336511     | 0.887987               | 0.306425          | 0.975171     | 1.198604          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

-  bayesian_optimization

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.215893      | 0.423689     | 0.509554               | 0.333632          | 0.647098     | 0.530664          |
  | return_data_combined_cvar_coef | 0.183488      | 0.483856     | 0.37922                | 0.296028          | 0.619833     | 0.390774          |
  | return_data_combined_ic        | 0.133474      | 0.597944     | 0.223222               | 0.328487          | 0.406331     | 0.111673          |
  | return_data_combined_cvar_ic   | 0.200351      | 0.408607     | 0.490326               | 0.324859          | 0.616731     | 0.486641          |
  | return_data_combined_corr      | 0.33276       | 0.388302     | 0.856964               | 0.325021          | 1.023812     | 1.249991          |
  | return_data_combined_cvar_corr | 0.310668      | 0.365722     | 0.849466               | 0.33938           | 0.915401     | 1.098332          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.197198      | 0.478087     | 0.412473               | 0.311742          | 0.632568     | 0.462927          |
  | return_data_combined_cvar_coef | 0.245387      | 0.505818     | 0.485129               | 0.31251           | 0.785213     | 0.696356          |
  | return_data_combined_ic        | 0.131728      | 0.543385     | 0.242421               | 0.315036          | 0.418136     | 0.101261          |
  | return_data_combined_cvar_ic   | 0.224535      | 0.382413     | 0.587153               | 0.315127          | 0.712522     | 0.6251            |
  | return_data_combined_corr      | 0.40037       | 0.325188     | 1.231196               | 0.329074          | 1.216658     | 1.538153          |
  | return_data_combined_cvar_corr | 0.315159      | 0.333094     | 0.946157               | 0.321598          | 0.97998      | 1.233917          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

- particle_swarm_optimization

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.215567      | 0.424114     | 0.508275               | 0.333538          | 0.646303     | 0.52943           |
  | return_data_combined_cvar_coef | 0.206349      | 0.509359     | 0.405115               | 0.32162           | 0.641593     | 0.417717          |
  | return_data_combined_ic        | 0.133224      | 0.600103     | 0.222002               | 0.328668          | 0.405345     | 0.110297          |
  | return_data_combined_cvar_ic   | 0.115846      | 0.583596     | 0.198503               | 0.325465          | 0.355939     | 0.018976          |
  | return_data_combined_corr      | 0.332912      | 0.387633     | 0.858834               | 0.324966          | 1.024454     | 1.251016          |
  | return_data_combined_cvar_corr | 0.323814      | 0.356761     | 0.907651               | 0.344882          | 0.938915     | 1.065184          |
  | return_data_combined_hs300     | 0.112023      | 0.427075     | 0.262303               | 0.248             | 0.451705     | 0                 |

- nlopt_optimization

  在160月左右求解比较慢；

- minimize_cvar_scipy

  | Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
  | ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
  | return_data_combined_coef      | 0.197439      | 0.480131     | 0.411219               | 0.311777          | 0.633272     | 0.464119          |
  | return_data_combined_cvar_coef | 0.239403      | 0.403115     | 0.593883               | 0.325077          | 0.73645      | 0.600633          |
  | return_data_combined_ic        | 0.131594      | 0.54091      | 0.243283               | 0.314983          | 0.417782     | 0.100613          |
  | return_data_combined_cvar_ic   | 0.212318      | 0.458771     | 0.462798               | 0.344778          | 0.615811     | 0.455351          |
  | return_data_combined_corr      | 0.400562      | 0.324029     | 1.236191               | 0.328996          | 1.217527     | 1.539813          |
  | return_data_combined_cvar_corr | 0.362671      | 0.337096     | 1.075868               | 0.34129           | 1.062647     | 1.256192          |
  | return_data_combined_hs300     | 0.113694      | 0.427075     | 0.266215               | 0.247964          | 0.45851      | 0                 |

## 自动调参

![调参结果](https://jingpic.oss-cn-hangzhou.aliyuncs.com/pic/Screenshot%202023-12-16%20194710.png)

```python
    train_min_months = 35 #训练最少使用数据量
    train_start_month = 95 #训练开始时间 或者从94开始，避免回撤过大，年均收益率更高
    train_max_months = 48 #训练最多使用数据量
    train_update_months = 5 #训练轮动周期
    max_date = 284
    max_select = 20 #选股最多数量
    roll_back = 25 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
    CVaR_method = "minimize_cvar_scipy"
    # 优化算法
    # "differential_evolution", "genetic_algorithm", "simulated_annealing",
    # "bayesian_optimization", "particle_swarm_optimization"
    # "nlopt_optimization", "minimize_cvar_scipy"
    confidence_level = 0.98 #置信水平
    risk_free_rate = 0  # 无风险利率假设为0
```

| Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
| ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
| return_data_combined_coef      | 0.174859      | 0.452481     | 0.386444               | 0.307948          | 0.56782      | 0.304579          |
| return_data_combined_cvar_coef | 0.19216       | 0.627649     | 0.306159               | 0.324658          | 0.591885     | 0.312975          |
| return_data_combined_ic        | 0.136666      | 0.610718     | 0.223779               | 0.316949          | 0.431192     | 0.081398          |
| return_data_combined_cvar_ic   | 0.148514      | 0.50059      | 0.296679               | 0.307583          | 0.482844     | 0.142811          |
| return_data_combined_corr      | 0.366127      | 0.37333      | 0.980705               | 0.325             | 1.126543     | 1.316669          |
| return_data_combined_cvar_corr | 0.372963      | 0.32533      | 1.146413               | 0.342362          | 1.089381     | 1.242343          |
| return_data_combined_hs300     | 0.122074      | 0.427075     | 0.285838               | 0.249161          | 0.48994      | 0                 |

```python
train_min_months = 69 #训练最少使用数据量
train_start_month = 95 #训练开始时间 或者从94开始，避免回撤过大，年均收益率更高
train_max_months = 48 #训练最多使用数据量
train_update_months = 10 #训练轮动周期
max_date = 284
max_select = 46 #选股最多数量
roll_back = 48 #决策集回溯地历史数据，从12个月开始调整，间隔周期为6个月，18个月长期收益表现可以
CVaR_method = "minimize_cvar_scipy"
# 优化算法
# "differential_evolution", "genetic_algorithm", "simulated_annealing",
# "bayesian_optimization", "particle_swarm_optimization"
# "nlopt_optimization", "minimize_cvar_scipy"
confidence_level = 0.95 #置信水平
risk_free_rate = 0  # 无风险利率假设为0
```

| Column                         | Annual Return | Max Drawdown | Return Drawdown  Ratio | Annual Volatility | Sharpe Ratio | Information Ratio |
| ------------------------------ | ------------- | ------------ | ---------------------- | ----------------- | ------------ | ----------------- |
| return_data_combined_coef      | 0.119853      | 0.413971     | 0.289521               | 0.269626          | 0.444517     | 0.213713          |
| return_data_combined_cvar_coef | 0.183912      | 0.391267     | 0.470043               | 0.268076          | 0.686046     | 0.597312          |
| return_data_combined_ic        | 0.144337      | 0.475383     | 0.303623               | 0.275394          | 0.524111     | 0.383682          |
| return_data_combined_cvar_ic   | 0.168117      | 0.397155     | 0.423304               | 0.272956          | 0.615914     | 0.514897          |
| return_data_combined_corr      | 0.223303      | 0.364247     | 0.613055               | 0.236181          | 0.945476     | 0.947762          |
| return_data_combined_cvar_corr | 0.242335      | 0.37116      | 0.652912               | 0.278728          | 0.869433     | 0.971812          |
| return_data_combined_hs300     | 0.088899      | 0.405584     | 0.219187               | 0.226506          | 0.392478     | 0                 |